"use strict";const e=require("vue"),C=require("../../../../node_modules/.pnpm/@vueuse_core@12.8.2_typescript@5.8.2/node_modules/@vueuse/core/index.js"),H=require("../../../utils/create.js"),E=require("../../../utils/utils.js"),T=require("./typography.js"),S=require("../../icon/index.js"),w=e.defineComponent({name:"tl-paragraph",__name:"paragraph",props:T.paragraphProps,emits:T.paragraphEmits,setup(b,{emit:q}){const p=H.createNamespace("paragraph"),l=b,h=q,v=e.ref(),g=e.ref(),{copy:z}=C.useClipboard({legacy:!0}),s=e.ref(l.open),x=e.ref(l.moreable);let a="",d="";e.onMounted(()=>{if(l.rows===0||!x.value)return;const t=v.value,n=g.value,{width:f}=C.useElementSize(t),{execute:m}=E.debounce(k,200),{fontSize:c,lineHeight:i}=getComputedStyle(n),o=Math.round(l.rows*parseFloat(i)),y=parseInt(c);a=n.innerText,t.style.maxHeight=`${o}px`,e.watch(f,(r,u)=>{s.value||(r-u>y?m(t,n,o,!0):t.scrollHeight>o&&m(t,n,o))}),e.watch(()=>l.open,r=>s.value=r),e.watch(s,r=>{r?(n.innerText=a,t.style.maxHeight="none"):(t.style.maxHeight=`${o}px`,k(t,n,o,!0)),h("changeOpen",r),h("update:open",r)},{immediate:!0})});function k(t,n,f,m=!1){let c=0,i=a.length;for(;c<i;){const u=Math.floor((c+i)/2);d=a.slice(0,u).concat("..."),n.innerText=d,t.scrollHeight>f?i=u:c=u+1}let o=a.slice(0,c-1).concat("...");const y=d.length-3+1===a.length;let r=l.moreable;m&&y&&(o=a,r=!1),x.value=r,n.innerText=o}function B(){const t=e.ref(g.value.innerText);h("copyBefore",t),z(t.value)}return(t,n)=>(e.openBlock(),e.createElementBlock("p",{ref_key:"containerRef",ref:v,class:e.normalizeClass([e.unref(p).b()])},[e.createElementVNode("span",{ref_key:"textRef",ref:g,class:e.normalizeClass([e.unref(p).e("text")])},[e.renderSlot(t.$slots,"default")],2),t.copyable?(e.openBlock(),e.createBlock(e.unref(S),{key:0,class:e.normalizeClass(e.unref(p).e("copy")),icon:"fa-copy",onClick:B},null,8,["class"])):e.createCommentVNode("",!0),x.value?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass([e.unref(p).e("more")]),onClick:n[0]||(n[0]=f=>s.value=!s.value)},e.toDisplayString(s.value?t.closeText:t.openText),3)):e.createCommentVNode("",!0)],2))}});module.exports=w;
