"use strict";const e=require("vue"),E=require("../../../utils/create.js"),z=require("./hook/use-img-load-status.js"),l=require("./utils.js"),w=require("../index.js"),_=["src"],B={class:"icon"},L={key:0,class:"alt"},b={class:"title"},I={class:"description"},P=e.defineComponent({name:"tl-image",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(p){const t=E.createNamespace("image"),o=p,{isLoaded:f,isError:c,isLoading:u,setLoadStatus:i}=z(),n=e.ref(),v=e.computed(()=>l.pick(o,["width","height","title","alt"])),a=e.ref(!1),g=e.computed(()=>o.fit?{objectFit:o.fit}:{}),y=e.computed(()=>({width:l.normalizeImageSizeProp(o.width),height:d.value?void 0:l.normalizeImageSizeProp(o.height)})),d=e.computed(()=>o.title||o.description),s=e.ref(!1),h=r=>{o.isLazy?!n.value&&r&&(n.value=o.src):n.value=o.src,s.value=r};e.watch(()=>o.src,r=>{i("loading"),s.value&&(n.value=r),o.isLazy&&!s.value&&(n.value="")});const C=()=>i("loaded"),V=()=>i("error"),k=()=>{o.preview&&(a.value=!0)};return e.onMounted(()=>{i("loading")}),(r,m)=>{const N=e.resolveComponent("tl-icon");return e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([e.unref(t).b(),e.unref(c)&&e.unref(t).m("error"),e.unref(u)&&e.unref(t).m("loading")]),style:e.normalizeStyle(y.value)},[e.createElementVNode("img",e.mergeProps({class:e.unref(t).e("img"),style:g.value,src:n.value},v.value,{onLoad:C,onError:V,onClick:k}),null,16,_),e.unref(f)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(e.unref(t).e("overlay-container"))},[e.unref(c)?e.renderSlot(r.$slots,"error",{key:0},()=>[e.createElementVNode("div",{class:e.normalizeClass([e.unref(t).e("overlay"),e.unref(t).em("overlay","error")])},[e.createElementVNode("div",B,[e.renderSlot(r.$slots,"error-icon",{},()=>[e.createVNode(N,{icon:"fa-file-excel"})])]),o.alt?(e.openBlock(),e.createElementBlock("div",L,e.toDisplayString(o.alt),1)):e.createCommentVNode("",!0)],2)]):e.createCommentVNode("",!0),e.unref(u)?e.renderSlot(r.$slots,"loading",{key:1},()=>[e.createElementVNode("div",{class:e.normalizeClass([e.unref(t).e("overlay"),e.unref(t).em("overlay","loading")])},null,2)]):e.createCommentVNode("",!0)],2)),d.value?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass([e.unref(t).e("footer"),e.unref(t).em("footer",r.footerPosition)])},[e.createElementVNode("div",null,[e.createElementVNode("div",b,e.toDisplayString(o.title),1),e.createElementVNode("div",I,e.toDisplayString(o.description),1)]),e.createElementVNode("div",null,[e.renderSlot(r.$slots,"extra")])],2)):e.createCommentVNode("",!0),e.createVNode(e.unref(w.TlImagePreview),{visible:a.value,"onUpdate:visible":m[0]||(m[0]=S=>a.value=S),src:o.src,"popup-container":o.popupContainer,onCancel:o.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[e.unref(l.vObserveVisibility),h]])}}});module.exports=P;
